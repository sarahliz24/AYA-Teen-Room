{% extends 'blog/base.html' %}

{% load crispy_forms_tags %}

{% block content %}

<div class="container">
    <section class="mx-auto pt-3 col-lg-9">
            {% if request.user.is_authenticated %}
                <div>
                    <h1>{{ feedback_post.title }}</h1>
                    <p class="date">
                        Feedback by {{ feedback_post.author }}, on {{ feedback_post.published }}
                    </p>
                    <hr class="featurette-divider">
                    {{ feedback_post.content|linebreaks }}
                    {% if request.user == feedback_post.author %}
                    <a href="{% url  'blog:feedback_edit' feedback_post.slug %}">
                        <button>Edit</button></a>
                    <a href="{% url  'blog:delete_feedback' feedback_post.slug %}">
                        <button>Delete</button>
                        {% endif %}
                        <hr class="featurette-divider">
                        <hr class="featurette-divider">
                    </a>
                </div>


                <div class="container">
                    <h3>Reply from AYA staff</h3>
                    <div>
                        {% if comments.count == 0 %}
                        <p>No replies yet - The AYA team usually reply within 24 hours</p>
                        {% endif %}
                    </div>
                    <div>
                        {% for comment in comments %}
                        <p>Reply by {{ comment.author }}, on
                            <span>
                                {{ comment.comment_made }}
                            </span>
                        </p>
                        {{ comment.content }}
                        <a href="#">Edit</a>
                        <a href="{% url 'blog:delete_comment' comment.pk %}">Delete</a>
                        <hr class="featurette-divider">
                        {% endfor %}

                        {% if request.user.is_staff %}
                        <div>
                            <h4>AYA staff: Reply to feedback</h4>
                            <form method="post">
                                {{ comment_form|crispy }}
                                {% csrf_token %}
                                <button type="submit" class="btn btn-primary btn-lg">Submit</button>
                            </form>
                            <br>
                        </div>
                        {% endif %}
                    </div>    
                </div>
            {% else %}
            <p>you do not have permission to view this page</p>
            {% endif %}
    </section>
</div>
    
{% endblock content %}